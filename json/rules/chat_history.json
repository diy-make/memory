{
  "name": "chat_history",
  "description": "Configuration for identifying and storing chat history.",
  "location": "dynamic/stream/",
  "identification_protocol": {
    "step_1": "Determine the Process ID (PID) of the current agent process using `ps -o ppid= -p $$`. Note that `echo $$` gives the shell PID, which is a child of the agent process. You must trace up the process tree.",
    "step_2": "Trace the process ancestry upwards (using `ps -o ppid= -p <PID>`) until you find the `script` command that launched the session. This `script` process is the root of your current session hierarchy and contains the correct filename in its arguments.",
    "step_3": "Extract the specific chat log filename from the identified `script` command's arguments (e.g., `script -q -c gemini dynamic/stream/timestamp_gemini_chat.txt`). The timestamp in this filename is your session ID.",
    "step_4": "Verify that the identified file path exists in the filesystem using `ls` or `test -f`. Do NOT rely solely on timestamps found in `ps` output; matches must be exact.",
    "step_5": "If multiple matches occur, verify which file descriptor is actually open by the process using `lsof -p <PID>`."
  },
  "path_to_scripting": "Scripts must dynamically determine the active log file by tracing the process tree rather than guessing based on time. Use `ps` to find the `script` invocation that launched the current session and parse its arguments to find the exact `.txt` file path. Always verify file existence before proceeding."
}
